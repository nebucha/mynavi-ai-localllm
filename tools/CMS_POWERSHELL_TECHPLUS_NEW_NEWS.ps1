#!/usr/bin/env pwsh

#========================================================================
# TECH+記事をCMSへ入稿する
#========================================================================

#========================================================================
# スクリプトのあるディレクトリをコマンドパスへ追加
#========================================================================
Set-Item Env:Path "$PSScriptRoot;$env:Path"

#========================================================================
# WebDriver起動
#========================================================================
webdriver_edge_start.ps1

#========================================================================
# CMSへログイン
#========================================================================
CMS_POWERSHELL_LOGIN

#========================================================================
# TECH+ニュース記事の新規作成
#========================================================================
'TECH+ニュース記事新規作成処理をはじめます。'
Set-SeUrl -Url https://manage.news.mynavi.jp/admin/projects/new_techplus

#========================================================================
# 必要項目を設定
#========================================================================
'必要項目を設定します。'
CMS_POWERSHELL_TECHPLUS_SET_INIT_VALS

#========================================================================
# 入稿フローを実施
#========================================================================
'記事データのアップロード処理を開始します。'
CMS_POWERSHELL_TECHPLUS_UPLOAD_DATA

#========================================================================
# ニュース記事の新規作成ページにおける不要な要素を非表示に設定
#========================================================================
#'作業に必要ない要素を非表示へ変更します。'
#CMS_POWERSHELL_TECHPLUS_HIDE_UNNECESSARY

#========================================================================
# 掲載処理
#========================================================================
'掲載処理を行います。'
CMS_POWERSHELL_TECHPLUS_PUBLICATION

#========================================================================
# WebDriverを終了
#========================================================================
webdriver_edge_stop.ps1
